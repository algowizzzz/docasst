<!-- Right Pane - Chat & AI Suggestions -->
<div class="right-pane-content h-100 d-flex flex-column">
    <!-- Tabs Header -->
    <div class="p-2 border-bottom bg-white">
        <ul class="nav nav-tabs nav-tabs-sm" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="chat-tab" data-bs-toggle="tab" data-bs-target="#chat-pane" type="button" role="tab">
                    <i class="bi bi-chat"></i> Chat
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="comments-tab" data-bs-toggle="tab" data-bs-target="#comments-pane" type="button" role="tab">
                    <i class="bi bi-chat-square-text"></i> Comments
                    <span class="badge bg-primary ms-1" id="commentCountBadge" style="display: none;">0</span>
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="analysis-tab" data-bs-toggle="tab" data-bs-target="#analysis-pane" type="button" role="tab">
                    <i class="bi bi-file-text"></i> Analysis
                </button>
            </li>
        </ul>
    </div>

    <!-- Tab Content -->
    <div class="tab-content flex-grow-1 d-flex flex-column" style="overflow: hidden; min-height: 0;">
        <!-- Chat Pane -->
        <div class="tab-pane fade show active h-100 d-flex flex-column" id="chat-pane" role="tabpanel">
            <!-- Chat Header -->
            <div class="p-2 border-bottom bg-white">
                <div class="d-flex justify-content-between align-items-center">
                    <h6 class="mb-0 fw-semibold">RiskGPT Chat</h6>
                    <div class="btn-group btn-group-sm">
                        <button class="btn btn-outline-secondary" onclick="WorkspacePage.clearChat()" title="Clear chat">
                            <i class="bi bi-trash"></i>
                        </button>
                    </div>
                </div>
            </div>

    <!-- Chat Messages -->
    <div class="flex-grow-1 overflow-auto p-3" id="chatMessagesContainer">
        <div id="chatMessages">
            <!-- Chat messages will be rendered here -->
        </div>
        <div id="chatMessagesEnd"></div>
    </div>

    <!-- Selected Blocks Display -->
    <div id="selectedBlocksSection" class="border-top p-2 bg-light d-none">
        <small class="text-muted d-block mb-2">Selected blocks:</small>
        <div id="selectedBlocksList" class="d-flex flex-wrap gap-1">
            <!-- Selected blocks will be rendered here -->
        </div>
        <button class="btn btn-sm btn-link p-0 mt-1" onclick="WorkspacePage.clearSelectedBlocks()">
            Clear all
        </button>
    </div>

    <!-- Text Suggestion Display -->
    <div id="textSuggestionSection" class="border-top p-3 bg-warning bg-opacity-10 d-none">
        <div class="d-flex justify-content-between align-items-start mb-2">
            <strong class="small">AI Text Suggestion</strong>
            <button class="btn-close btn-close-sm" onclick="WorkspacePage.rejectTextSuggestion()"></button>
        </div>
        <div class="mb-2">
            <small class="text-muted d-block mb-1">Original:</small>
            <div class="bg-white p-2 rounded border" id="textSuggestionOriginal"></div>
        </div>
        <div class="mb-2">
            <small class="text-muted d-block mb-1">Suggested:</small>
            <div class="bg-white p-2 rounded border border-primary" id="textSuggestionSuggested"></div>
        </div>
        <div class="d-flex gap-2">
            <button class="btn btn-sm btn-primary" onclick="WorkspacePage.acceptTextSuggestion()">
                Accept
            </button>
            <button class="btn btn-sm btn-outline-secondary" onclick="WorkspacePage.rejectTextSuggestion()">
                Reject
            </button>
        </div>
    </div>

            <!-- Chat Input -->
            <div class="border-top p-3 bg-white chat-input-container">
                <div class="input-group">
                    <textarea 
                        id="chatInput" 
                        class="form-control" 
                        rows="2" 
                        placeholder="Ask RiskGPT for help..."
                        onkeydown="if(event.key === 'Enter' && (event.ctrlKey || event.metaKey)) { WorkspacePage.sendChatMessage(); }"
                    ></textarea>
                    <button 
                        id="btnSendChat" 
                        class="btn btn-primary" 
                        onclick="WorkspacePage.sendChatMessage()"
                    >
                        <i class="bi bi-send"></i>
                    </button>
                </div>
                <small class="text-muted">Press Ctrl+Enter to send</small>
            </div>
        </div>

        <!-- Comments Pane -->
        <div class="tab-pane fade h-100 d-flex flex-column" id="comments-pane" role="tabpanel" aria-labelledby="comments-tab">
            <!-- Comments Header -->
            <div class="p-3 border-bottom bg-white">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <h6 class="mb-0 fw-semibold">
                        <i class="bi bi-chat-square-text"></i> Comments
                    </h6>
                    <div class="btn-group btn-group-sm">
                        <button class="btn btn-outline-secondary" onclick="WorkspacePage.toggleShowResolvedComments()" id="toggleResolvedBtn" title="Toggle resolved comments">
                            <i class="bi bi-eye"></i> Show Resolved
                        </button>
                        <button class="btn btn-outline-secondary" onclick="WorkspacePage.refreshComments()" title="Refresh comments">
                            <i class="bi bi-arrow-clockwise"></i>
                        </button>
                    </div>
                </div>
                <small class="text-muted" id="commentsSummary">No comments</small>
            </div>

            <!-- Comments List -->
            <div class="flex-grow-1 overflow-auto p-3" id="commentsListContainer">
                <div id="commentsList">
                    <div class="text-center text-muted py-5">
                        <i class="bi bi-chat-square-text" style="font-size: 3rem;"></i>
                        <p class="mt-3">No comments yet</p>
                        <small>Select text and click the comment button to add a comment</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analysis Pane -->
        <div class="tab-pane fade h-100 d-flex flex-column" id="analysis-pane" role="tabpanel" aria-labelledby="analysis-tab">
            <!-- Analysis Header -->
            <div class="p-3 border-bottom bg-white">
                <div class="d-flex justify-content-between align-items-start">
                    <div class="flex-grow-1">
                        <h6 class="mb-1 fw-semibold">Document Analysis</h6>
                        <small class="text-muted">Review AI-generated insights and suggestions</small>
                    </div>
                    <button 
                        id="btnAnalyzeDocument" 
                        class="btn btn-primary btn-sm"
                        onclick="WorkspacePage.analyzeDocument()"
                    >
                        <i class="bi bi-play-fill"></i> Analyze
                    </button>
                </div>
                <div id="analysisStatus" class="mt-2 d-none">
                    <span class="badge bg-success" id="analysisStatusBadge">0 sections analyzed</span>
                </div>
            </div>

            <!-- Analysis Content -->
            <div class="flex-grow-1 overflow-auto p-3" id="analysisContent">
                <!-- Analysis Sections (render first) -->
                <div id="analysisSections" class="d-none">
                    <!-- Analysis sections will be rendered here -->
                </div>

                <!-- Empty State (render after sections) -->
                <div id="analysisEmpty" class="text-center py-5">
                    <i class="bi bi-info-circle text-muted" style="font-size: 2.5rem;"></i>
                    <p class="text-muted mt-3 mb-0">Select a document to view analysis</p>
                </div>
            </div>
        </div>
    </div>
</div>

